import os
import logging
from datetime import datetime, timedelta
from telegram import Update, ReplyKeyboardMarkup
from telegram.ext import Application, CommandHandler, MessageHandler, filters, ContextTypes

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)

# –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –ß–ï–¢–ù–û–ô –Ω–µ–¥–µ–ª–∏
EVEN_WEEK = {
    "–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫": [
        "08:00-09:30 - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è [–∫.1 412] (–ë–ê–ó–ï–ï–í–ê –ù.–ê.)",
        "09:45-11:15 - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ [–∫.1 412] (–ö–ê–õ–ò–ù–ò–ß–ï–í –°.–Æ.)",
        "11:35-13:05 - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è [–∫.27 407] (–ë–ê–ó–ï–ï–í–ê –ù.–ê.)",
        "13:20-14:50 - –ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫ –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ [–∫.27 203] (–ö–û–õ–ï–°–ù–ò–ö–û–í–ê –ù.–ù.)"
    ],
    "–≤—Ç–æ—Ä–Ω–∏–∫": [
        "13:20-14:50 - –≠–ª–µ–º–µ–Ω—Ç—ã –≤—ã—Å—à–µ–π –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ [–∫.1 412] (–ö–ò–°–ï–õ–ï–í–ê –ò.–í.)",
        "15:00-16:30 - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ [–∫.1 412] (–ö–ò–°–ï–õ–ï–í–ê –ò.–í.)"
    ],
    "—Å—Ä–µ–¥–∞": [
        "08:00-09:30 - –§–∏–∑–∏—á–µ—Å–∫–∞—è –∫—É–ª—å—Ç—É—Ä–∞ / –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –∫—É–ª—å—Ç—É—Ä–∞ [–∫.–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ —Å–æ–æ—Ä—É–∂–µ–Ω–∏—è —Å—Ç–∞–¥–∏–æ–Ω–∞ '–°—Ç–∞—Ä—Ç' –±/–Ω] (–•–ê–ë–ê–†–û–í–ê –ï.–ù.)",
        "09:45-11:15 - –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ —Å—Ä–µ–¥—ã [–∫.27 503] (–ö–ê–õ–ò–ù–ò–ß–ï–í –°.–Æ.)"
    ],
    "—á–µ—Ç–≤–µ—Ä–≥": [
        "13:20-14:50 - –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ —Å—Ä–µ–¥—ã [–∫.1 412] (–ö–ê–õ–ò–ù–ò–ß–ï–í –°.–Æ.)",
        "15:00-16:30 - –†—É—Å—Å–∫–∏–π —è–∑—ã–∫ –∏ –∫—É–ª—å—Ç—É—Ä–∞ —Ä–µ—á–∏ / –ö–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–∞–∫—Ç–∏–∫—É–º [–∫.1 412] (–†–û–ú–ê–ù–û–í–ê –ï.–ò.)",
        "16:40-18:10 - –†—É—Å—Å–∫–∏–π —è–∑—ã–∫ –∏ –∫—É–ª—å—Ç—É—Ä–∞ —Ä–µ—á–∏ / –ö–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–∞–∫—Ç–∏–∫—É–º [–∫.1 412] (–†–û–ú–ê–ù–û–í–ê –ï.–ò.)"
    ],
    "–ø—è—Ç–Ω–∏—Ü–∞": [
        "13:20-14:50 - –ò—Å—Ç–æ—Ä–∏—è [–∫.1 412] (–ö–û–¢–õ–û–í –ê.–ò.)",
        "15:00-16:30 - –í–≤–µ–¥–µ–Ω–∏–µ –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å / –ü—Å–∏—Ö–æ–ª–æ–≥–∏—è –ª–∏—á–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–∞–º–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ [–∫.27 306] (–ì–û–õ–û–í–ê–ù–û–í–ê –ù.–§.)"
    ],
    "—Å—É–±–±–æ—Ç–∞": [
        "08:00-09:30 - –≠–ª–µ–º–µ–Ω—Ç—ã –≤—ã—Å—à–µ–π –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ [–∫.1 426] (–ö–ò–°–ï–õ–ï–í–ê –ò.–í.)",
        "09:45-11:15 - –û—Å–Ω–æ–≤—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è [–∫.27 503] (–ü–ï–¢–Ø–ù–ö–ò–ù –ú.–§.)",
        "11:35-13:05 - –û—Å–Ω–æ–≤—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è [–∫.1 412] (–ü–ï–¢–Ø–ù–ö–ò–ù –ú.–§.)"
    ],
    "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ": ["–í—ã—Ö–æ–¥–Ω–æ–π"]
}

# –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –ù–ï–ß–ï–¢–ù–û–ô –Ω–µ–¥–µ–ª–∏
ODD_WEEK = {
    "–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫": [
        "08:00-09:30 - –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ [–∫.1 412] (–ë–ê–ó–ï–ï–í –î.–í.)",
        "09:45-11:15 - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è [–∫.1 412] (–ë–ê–ó–ï–ï–í–ê –ù.–ê.)",
        "11:35-13:05 - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è [–∫.27 407] (–ë–ê–ó–ï–ï–í–ê –ù.–ê.)",
        "13:20-14:50 - –ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫ –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ [–∫.27 203] (–ö–û–õ–ï–°–ù–ò–ö–û–í–ê –ù.–ù.)",
        "15:00-16:30 - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ [–∫.27 203] (–ö–ò–°–ï–õ–ï–í–ê –ò.–í.)"
    ],
    "–≤—Ç–æ—Ä–Ω–∏–∫": [
        "11:35-13:05 - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ [–∫.27 503] (–ö–ê–õ–ò–ù–ò–ß–ï–í –°.–Æ.)",
        "13:20-14:50 - –≠–ª–µ–º–µ–Ω—Ç—ã –≤—ã—Å—à–µ–π –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ [–∫.1 412] (–ö–ò–°–ï–õ–ï–í–ê –ò.–í.)"
    ],
    "—Å—Ä–µ–¥–∞": [
        "08:00-09:30 - –§–∏–∑–∏—á–µ—Å–∫–∞—è –∫—É–ª—å—Ç—É—Ä–∞ / –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –∫—É–ª—å—Ç—É—Ä–∞ [–∫.–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ —Å–æ–æ—Ä—É–∂–µ–Ω–∏—è —Å—Ç–∞–¥–∏–æ–Ω–∞ '–°—Ç–∞—Ä—Ç' –±/–Ω] (–•–ê–ë–ê–†–û–í–ê –ï.–ù.)",
        "09:45-11:15 - –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ —Å—Ä–µ–¥—ã [–∫.27 503] (–ö–ê–õ–ò–ù–ò–ß–ï–í –°.–Æ.)",
        "11:35-13:05 - –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ [–∫.27 507] (–ë–ê–ó–ï–ï–í –î.–í.)"
    ],
    "—á–µ—Ç–≤–µ—Ä–≥": [
        "13:20-14:50 - –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ —Å—Ä–µ–¥—ã [–∫.1 412] (–ö–ê–õ–ò–ù–ò–ß–ï–í –°.–Æ.)",
        "15:00-16:30 - –†—É—Å—Å–∫–∏–π —è–∑—ã–∫ –∏ –∫—É–ª—å—Ç—É—Ä–∞ —Ä–µ—á–∏ / –ö–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–∞–∫—Ç–∏–∫—É–º [–∫.1 412] (–†–û–ú–ê–ù–û–í–ê –ï.–ò.)"
    ],
    "–ø—è—Ç–Ω–∏—Ü–∞": [
        "11:35-13:05 - –í–≤–µ–¥–µ–Ω–∏–µ –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å / –ü—Å–∏—Ö–æ–ª–æ–≥–∏—è –ª–∏—á–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–∞–º–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ [–∫.1 412] (–ì–û–õ–û–í–ê–ù–û–í–ê –ù.–§.)",
        "13:20-14:50 - –ò—Å—Ç–æ—Ä–∏—è [–∫.1 412] (–ö–û–¢–õ–û–í –ê.–ò.)",
        "15:00-16:30 - –ò—Å—Ç–æ—Ä–∏—è [–∫.1 420] (–ö–û–¢–õ–û–í –ê.–ò.)",
        "16:40-18:10 - –≠–ª–µ–º–µ–Ω—Ç—ã –≤—ã—Å—à–µ–π –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ [–∫.1 424] (–ö–ò–°–ï–õ–ï–í–ê –ò.–í.)"
    ],
    "—Å—É–±–±–æ—Ç–∞": [
        "08:00-09:30 - –≠–ª–µ–º–µ–Ω—Ç—ã –≤—ã—Å—à–µ–π –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ [–∫.1 426] (–ö–ò–°–ï–õ–ï–í–ê –ò.–í.)",
        "09:45-11:15 - –û—Å–Ω–æ–≤—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è [–∫.27 503] (–ü–ï–¢–Ø–ù–ö–ò–ù –ú.–§.)",
        "11:35-13:05 - –û—Å–Ω–æ–≤—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è [–∫.1 412] (–ü–ï–¢–Ø–ù–ö–ò–ù –ú.–§.)"
    ],
    "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ": ["–í—ã—Ö–æ–¥–Ω–æ–π"]
}

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –Ω–µ–¥–µ–ª–∏ (—á–µ—Ç–Ω–∞—è/–Ω–µ—á–µ—Ç–Ω–∞—è)
def get_week_type():
    week_number = datetime.now().isocalendar()[1]
    return 'even' if week_number % 2 == 0 else 'odd'

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä—É—Å—Å–∫–æ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏—è –¥–Ω—è –Ω–µ–¥–µ–ª–∏
def get_russian_day_name(weekday):
    days = ["–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", "–≤—Ç–æ—Ä–Ω–∏–∫", "—Å—Ä–µ–¥–∞", "—á–µ—Ç–≤–µ—Ä–≥", "–ø—è—Ç–Ω–∏—Ü–∞", "—Å—É–±–±–æ—Ç–∞", "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ"]
    return days[weekday]

# –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –¥–Ω—è–º–∏ –Ω–µ–¥–µ–ª–∏
keyboard = [
    ["–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", "–í—Ç–æ—Ä–Ω–∏–∫", "–°—Ä–µ–¥–∞"],
    ["–ß–µ—Ç–≤–µ—Ä–≥", "–ü—è—Ç–Ω–∏—Ü–∞", "–°—É–±–±–æ—Ç–∞"],
    ["–°–µ–≥–æ–¥–Ω—è", "–ó–∞–≤—Ç—Ä–∞", "–ù–µ–¥–µ–ª—è"],
    ["–¢–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è", "–°–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è"]
]

reply_markup = ReplyKeyboardMarkup(keyboard, resize_keyboard=True)

# –ö–æ–º–∞–Ω–¥–∞ /start
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    week_type = get_week_type()
    week_name = "–ß–ï–¢–ù–ê–Ø" if week_type == 'even' else "–ù–ï–ß–ï–¢–ù–ê–Ø"
    
    await update.message.reply_text(
        f"üéì –ë–æ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –ú–Ω–æ–≥–æ–ø—Ä–æ—Ñ–∏–ª—å–Ω–æ–≥–æ –∫–æ–ª–ª–µ–¥–∂–∞\n"
        f"üìÖ –°–µ–π—á–∞—Å {week_name} –Ω–µ–¥–µ–ª—è\n\n"
        "–í—ã–±–µ—Ä–∏ –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–∞–Ω–¥—ã:\n"
        "/today - —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è\n"
        "/tomorrow - —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –∑–∞–≤—Ç—Ä–∞\n"
        "/week - —Ç–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è\n"
        "/next_week - —Å–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è",
        reply_markup=reply_markup
    )

# –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –¥–Ω—è
async def send_day_schedule(update: Update, day_type: str):
    if day_type == 'today':
        date = datetime.now()
        day_name_russian = get_russian_day_name(date.weekday())
    elif day_type == 'tomorrow':
        date = datetime.now() + timedelta(days=1)
        day_name_russian = get_russian_day_name(date.weekday())
    else:
        day_name_russian = day_type.lower()
    
    week_type = get_week_type()
    schedule = EVEN_WEEK if week_type == 'even' else ODD_WEEK
    week_name = "–ß–ï–¢–ù–ê–Ø" if week_type == 'even' else "–ù–ï–ß–ï–¢–ù–ê–Ø"
    
    lessons = schedule.get(day_name_russian, [])
    
    if lessons and lessons[0] != "–í—ã—Ö–æ–¥–Ω–æ–π":
        text = f"üìÖ {day_name_russian.capitalize()} ({week_name} –Ω–µ–¥–µ–ª—è):\n\n"
        for lesson in lessons:
            text += f"‚Ä¢ {lesson}\n"
    else:
        text = f"üìÖ {day_name_russian.capitalize()} ({week_name} –Ω–µ–¥–µ–ª—è):\n‚Ä¢ {lessons[0] if lessons else '–ù–µ—Ç –ø–∞—Ä'}"
    
    await update.message.reply_text(text)

# –ö–æ–º–∞–Ω–¥–∞ /today
async def today(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await send_day_schedule(update, 'today')

# –ö–æ–º–∞–Ω–¥–∞ /tomorrow
async def tomorrow(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await send_day_schedule(update, 'tomorrow')

# –ö–æ–º–∞–Ω–¥–∞ /week
async def week(update: Update, context: ContextTypes.DEFAULT_TYPE):
    week_type = get_week_type()
    schedule = EVEN_WEEK if week_type == 'even' else ODD_WEEK
    week_name = "–ß–ï–¢–ù–ê–Ø" if week_type == 'even' else "–ù–ï–ß–ï–¢–ù–ê–Ø"
    
    text = f"üìö –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ {week_name} –Ω–µ–¥–µ–ª—é:\n\n"
    for day, lessons in schedule.items():
        text += f"üìÖ {day.capitalize()}:\n"
        if lessons and lessons[0] != "–í—ã—Ö–æ–¥–Ω–æ–π":
            for lesson in lessons:
                text += f"‚Ä¢ {lesson}\n"
        else:
            text += f"‚Ä¢ {lessons[0]}\n"
        text += "\n"
    
    await update.message.reply_text(text)

# –ö–æ–º–∞–Ω–¥–∞ /next_week
async def next_week(update: Update, context: ContextTypes.DEFAULT_TYPE):
    week_type = 'odd' if get_week_type() == 'even' else 'even'
    schedule = EVEN_WEEK if week_type == 'even' else ODD_WEEK
    week_name = "–ß–ï–¢–ù–ê–Ø" if week_type == 'even' else "–ù–ï–ß–ï–¢–ù–ê–Ø"
    
    text = f"üìö –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –°–õ–ï–î–£–Æ–©–£–Æ ({week_name}) –Ω–µ–¥–µ–ª—é:\n\n"
    for day, lessons in schedule.items():
        text += f"üìÖ {day.capitalize()}:\n"
        if lessons and lessons[0] != "–í—ã—Ö–æ–¥–Ω–æ–π":
            for lesson in lessons:
                text += f"‚Ä¢ {lesson}\n"
        else:
            text += f"‚Ä¢ {lessons[0]}\n"
        text += "\n"
    
    await update.message.reply_text(text)

# –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    text = update.message.text.lower()
    
    if text in ['–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–≤—Ç–æ—Ä–Ω–∏–∫', '—Å—Ä–µ–¥–∞', '—á–µ—Ç–≤–µ—Ä–≥', '–ø—è—Ç–Ω–∏—Ü–∞', '—Å—É–±–±–æ—Ç–∞', '–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ']:
        await send_day_schedule(update, text)
    elif text == '—Å–µ–≥–æ–¥–Ω—è':
        await today(update, context)
    elif text == '–∑–∞–≤—Ç—Ä–∞':
        await tomorrow(update, context)
    elif text in ['–Ω–µ–¥–µ–ª—è', '—Ç–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è']:
        await week(update, context)
    elif text == '—Å–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è':
        await next_week(update, context)
    else:
        await update.message.reply_text(
            "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –∏–ª–∏ –∫–æ–º–∞–Ω–¥—ã:\n"
            "/today - —Å–µ–≥–æ–¥–Ω—è\n/tomorrow - –∑–∞–≤—Ç—Ä–∞\n/week - –Ω–µ–¥–µ–ª—è\n/next_week - —Å–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è"
        )

def main():
    # –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è Railway
    token = os.environ['TELEGRAM_TOKEN']
    application = Application.builder().token(token).build()

    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    application.add_handler(CommandHandler("start", start))
    application.add_handler(CommandHandler("today", today))
    application.add_handler(CommandHandler("tomorrow", tomorrow))
    application.add_handler(CommandHandler("week", week))
    application.add_handler(CommandHandler("next_week", next_week))
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))

    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    print("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –Ω–∞ Railway...")
    application.run_polling()

if __name__ == '__main__':
    main()
